#!/bin/bash

if [ -z "$1" ]; then
  echo "Usage: ./bin/add_google_credentials /path/to/service-account.json"
  exit 1
fi

if [ ! -f "$1" ]; then
  echo "Error: File $1 not found"
  exit 1
fi

echo "Encoding Google Service Account JSON..."
ENCODED=$(base64 -i "$1" | tr -d '\n')

# Remove existing GOOGLE_SERVICE_ACCOUNT_JSON line if present
sed -i.bak '/GOOGLE_SERVICE_ACCOUNT_JSON=/d' .env

# Add new encoded value
echo "GOOGLE_SERVICE_ACCOUNT_JSON=$ENCODED" >> .env

echo "âœ… Google Service Account JSON added to .env"
echo "You can now start the application!"
