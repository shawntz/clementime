<nav
  class="bg-gradient-to-r from-orange-500 to-orange-600 text-white p-4 shadow-lg"
  x-data="{ mobileMenuOpen: false }"
>
  <div class="container mx-auto flex justify-between items-center">
    <div>
      <h1 class="text-xl font-bold">
        <%= config.web_ui?.navbar_title || 'Session Scheduler' %>
      </h1>
      <a
        href="https://github.com/shawntz/clementime"
        target="_blank"
        class="text-xs text-orange-100 hover:text-white transition-colors duration-200 flex items-center mt-1"
      >
        🍊 Powered by Clementime
      </a>
    </div>

    <div class="flex items-center space-x-4">
      <!-- Mobile Menu Button -->
      <button
        @click="mobileMenuOpen = !mobileMenuOpen"
        class="md:hidden flex items-center justify-center w-8 h-8 rounded-lg hover:bg-orange-400 hover:bg-opacity-20 transition-colors duration-200"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>

      <!-- Navigation Links -->
      <div class="hidden md:flex space-x-4">
        <a
          href="/"
          class="hover:text-orange-200 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'dashboard' ? 'font-semibold border-b-2 border-orange-200 pb-1' : '' %>"
          >🚀 Dashboard</a
        >
        <a
          href="/schedules"
          class="hover:text-orange-200 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'schedules' ? 'font-semibold border-b-2 border-orange-200 pb-1' : '' %>"
          >📅 Schedules</a
        >
        <a
          href="/recording"
          class="hover:text-orange-200 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'recording' ? 'font-semibold border-b-2 border-orange-200 pb-1' : '' %>"
          >🎙️ Recording</a
        >
        <a
          href="/config"
          class="hover:text-orange-200 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'config' ? 'font-semibold border-b-2 border-orange-200 pb-1' : '' %>"
          >⚙️ Config</a
        >
        <% if (typeof user !== 'undefined' && user && user.role === 'admin') { %>
        <a
          href="/admin/users"
          class="hover:text-orange-200 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'admin' ? 'font-semibold border-b-2 border-orange-200 pb-1' : '' %>"
          >👥 Users</a
        >
        <% } %>
      </div>

      <!-- Profile Menu -->
      <div class="relative" x-data="{ open: false }">
        <button
          @click="open = !open"
          @click.outside="open = false"
          class="flex items-center space-x-2 hover:bg-orange-400 hover:bg-opacity-20 rounded-lg p-2 transition-colors duration-200"
        >
          <% if (typeof user !== 'undefined' && user && user.picture) { %>
            <img src="<%= user.picture %>" alt="Profile" class="w-8 h-8 rounded-full border-2 border-orange-200">
          <% } else { %>
            <div class="w-8 h-8 rounded-full bg-orange-300 flex items-center justify-center text-orange-800 font-semibold">
              <% if (typeof user !== 'undefined' && user && user.name) { %>
                <%= user.name.charAt(0).toUpperCase() %>
              <% } else { %>
                U
              <% } %>
            </div>
          <% } %>
          <svg class="w-4 h-4 text-orange-200" :class="{ 'rotate-180': open }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>

        <!-- Dropdown Menu -->
        <div
          x-show="open"
          x-transition:enter="transition ease-out duration-200"
          x-transition:enter-start="opacity-0 scale-95"
          x-transition:enter-end="opacity-100 scale-100"
          x-transition:leave="transition ease-in duration-150"
          x-transition:leave-start="opacity-100 scale-100"
          x-transition:leave-end="opacity-0 scale-95"
          class="absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50"
          style="display: none;"
        >
          <!-- User Info -->
          <div class="px-4 py-3 border-b border-gray-200">
            <div class="flex items-center space-x-3">
              <% if (typeof user !== 'undefined' && user && user.picture) { %>
                <img src="<%= user.picture %>" alt="Profile" class="w-10 h-10 rounded-full">
              <% } else { %>
                <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center text-orange-800 font-semibold">
                  <% if (typeof user !== 'undefined' && user && user.name) { %>
                    <%= user.name.charAt(0).toUpperCase() %>
                  <% } else { %>
                    U
                  <% } %>
                </div>
              <% } %>
              <div>
                <p class="font-medium text-gray-900">
                  <% if (typeof user !== 'undefined' && user && user.name) { %>
                    <%= user.name %>
                  <% } else { %>
                    User
                  <% } %>
                </p>
                <p class="text-sm text-gray-500">
                  <% if (typeof user !== 'undefined' && user && user.email) { %>
                    <%= user.email %>
                  <% } else { %>
                    No email available
                  <% } %>
                </p>
              </div>
            </div>
          </div>

          <!-- Role Badge -->
          <div class="px-4 py-2">
            <% if (typeof user !== 'undefined' && user && user.role) { %>
              <% if (user.role === 'admin') { %>
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
                  🔑 Administrator
                </span>
              <% } else if (user.role === 'ta') { %>
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                  👨‍🏫 TA
                  <% if (user.sections && user.sections.length > 0) { %>
                    <span class="ml-1 text-xs">(<%= user.sections.join(', ') %>)</span>
                  <% } %>
                </span>
              <% } %>
            <% } else { %>
              <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                👤 User
              </span>
            <% } %>
          </div>

          <!-- Menu Items -->
          <div class="py-1">
            <% if (typeof user !== 'undefined' && user && user.role === 'admin') { %>
            <a href="/admin/users" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200">
              <svg class="w-4 h-4 mr-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-1a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
              </svg>
              Admin Dashboard
            </a>
            <% } %>
            <a href="/auth/logout" class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200">
              <svg class="w-4 h-4 mr-3 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
              </svg>
              Sign Out
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div
    x-show="mobileMenuOpen"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0 -translate-y-2"
    x-transition:enter-end="opacity-100 translate-y-0"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100 translate-y-0"
    x-transition:leave-end="opacity-0 -translate-y-2"
    class="md:hidden bg-orange-600 border-t border-orange-400 px-4 py-3"
    style="display: none;"
    @click.outside="mobileMenuOpen = false"
  >
    <div class="flex flex-col space-y-3">
      <a
        href="/"
        class="flex items-center py-2 px-3 rounded-lg hover:bg-orange-500 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'dashboard' ? 'bg-orange-500 font-semibold' : '' %>"
        @click="mobileMenuOpen = false"
      >🚀 Dashboard</a>
      <a
        href="/schedules"
        class="flex items-center py-2 px-3 rounded-lg hover:bg-orange-500 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'schedules' ? 'bg-orange-500 font-semibold' : '' %>"
        @click="mobileMenuOpen = false"
      >📅 Schedules</a>
      <a
        href="/recording"
        class="flex items-center py-2 px-3 rounded-lg hover:bg-orange-500 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'recording' ? 'bg-orange-500 font-semibold' : '' %>"
        @click="mobileMenuOpen = false"
      >🎙️ Recording</a>
      <a
        href="/config"
        class="flex items-center py-2 px-3 rounded-lg hover:bg-orange-500 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'config' ? 'bg-orange-500 font-semibold' : '' %>"
        @click="mobileMenuOpen = false"
      >⚙️ Config</a>
      <% if (typeof user !== 'undefined' && user && user.role === 'admin') { %>
      <a
        href="/admin/users"
        class="flex items-center py-2 px-3 rounded-lg hover:bg-orange-500 transition-colors duration-200 <%= typeof currentPage !== 'undefined' && currentPage === 'admin' ? 'bg-orange-500 font-semibold' : '' %>"
        @click="mobileMenuOpen = false"
      >👥 Users</a>
      <% } %>
    </div>
  </div>
</nav>
